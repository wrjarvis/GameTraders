{% extends "base.html" %}

{% block title %}Game Created - {{ game.name }}{% endblock %}

{% block content %}
<div class="success-container">
    <div class="success-header">
        <div class="success-icon">âœ…</div>
        <h1>Game Created Successfully!</h1>
        <p class="game-name">{{ game.name }}</p>
    </div>
    
    <div class="important-notice">
        <h2>âš ï¸ Important: Save These Links!</h2>
        <p>Each participant needs their unique link to access their trading dashboard. Share these privately - <strong>this page will not be shown again!</strong></p>
        <p style="margin-top: 0.5rem; color: #dc2626; font-weight: 600;">ğŸ”’ The <strong>Admin link</strong> (highlighted in red) is the only one that can end the game and declare a winner. Keep it secure!</p>
    </div>
    
    <div class="participant-links">
        <h2>Participant Access Links</h2>
        
        <table class="links-table">
            <thead>
                <tr>
                    <th>Participant</th>
                    <th>Role</th>
                    <th>Private Link</th>
                </tr>
            </thead>
            <tbody>
                {% for link in participant_links %}
                <tr {% if link.role == 'admin' %}class="admin-row"{% endif %}>
                    <td class="participant-name">
                        {{ link.name }}
                        {% if link.role == 'admin' %}<strong style="color: var(--danger-color);"> âš ï¸</strong>{% endif %}
                    </td>
                    <td><span class="role-badge role-{{ link.role }}">{{ link.role|title }}</span></td>
                    <td class="link-cell">
                        <input type="text" value="{{ link.link }}" readonly class="link-input" id="link-{{ loop.index }}">
                        <button class="btn btn-small btn-copy" onclick="copyLink('link-{{ loop.index }}')">ğŸ“‹ Copy</button>
                    </td>
                </tr>
                {% endfor %}
            </tbody>
        </table>
    </div>
    
    <div class="copy-all-section">
        <button class="btn btn-secondary" onclick="copyAllLinks()">ğŸ“‹ Copy All Links</button>
    </div>
    
    <div class="game-info">
        <h3>Game Details</h3>
        <ul>
            <li><strong>Tradeable Players:</strong> {{ game.player_names }}</li>
            <li><strong>Number of Traders:</strong> {{ game.num_players }}</li>
            <li><strong>Number of Viewers:</strong> {{ game.num_viewers }}</li>
        </ul>
    </div>
</div>

{% endblock %}

{% block extra_scripts %}
<script>
function copyLink(inputId) {
    const input = document.getElementById(inputId);
    input.select();
    document.execCommand('copy');
    
    const btn = input.nextElementSibling;
    const originalText = btn.innerHTML;
    btn.innerHTML = 'âœ“ Copied!';
    setTimeout(() => btn.innerHTML = originalText, 2000);
}

function copyAllLinks() {
    const links = [];
    {% for link in participant_links %}
    links.push("{{ link.name }} ({{ link.role }}): {{ link.link }}");
    {% endfor %}
    
    navigator.clipboard.writeText(links.join('\n')).then(() => {
        const btn = event.target;
        const originalText = btn.innerHTML;
        btn.innerHTML = 'âœ“ All Copied!';
        setTimeout(() => btn.innerHTML = originalText, 2000);
    });
}
</script>
{% endblock %}
